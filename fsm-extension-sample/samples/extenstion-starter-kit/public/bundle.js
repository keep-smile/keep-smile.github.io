(()=>{"use strict";var e={918:(e,t,i)=>{i.r(t),i.d(t,{ErrorType:()=>n,SHELL_EVENTS:()=>r,ShellSdk:()=>l});var n,r={Version1:{REQUIRE_CONTEXT:"V1.REQUIRE_CONTEXT",REQUIRE_AUTHENTICATION:"V1.REQUIRE_AUTHENTICATION",CLOSE:"V1.CLOSE",REQUIRE_PERMISSIONS:"V1.REQUIRE_PERMISSIONS",GET_PERMISSIONS:"V1.GET_PERMISSIONS",GET_SETTINGS:"V1.GET_SETTINGS",GET_STORAGE_ITEM:"V1.GET_STORAGE_ITEM",SET_STORAGE_ITEM:"V1.SET_STORAGE_ITEM",SET_VIEW_STATE:"V1.SET_VIEW_STATE",SET_TITLE:"V1.SET_TITLE",RESTORE_TITLE:"V1.RESTORE_TITLE",TO_APP:"V1.TO_APP",GET_FEATURE_FLAG:"V1.GET_FEATURE_FLAG",PRIVATE:{GET_ACCOUNT_SETTINGS:"V1.PRIVATE.GET_ACCOUNT_SETTINGS"},OUTLET:{ADD_PLUGIN:"V1.OUTLET.ADD_PLUGIN",REMOVE_PLUGIN:"V1.OUTLET.REMOVE_PLUGIN",REQUEST_CONTEXT:"V1.OUTLET.REQUEST_CONTEXT",LOADING_SUCCESS:"V1.OUTLET.LOADING_SUCCESS",LOADING_FAIL:"V1.OUTLET.LOADING_FAIL"}},Version2:{GET_STORAGE_ITEM:"V2.GET_STORAGE_ITEM",GET_PERMISSIONS:"V2.GET_PERMISSIONS"},ERROR:"ERROR"};!function(e){e.OUTLET_TIMEOUT="OUTLET_TIMEOUT",e.OUTLET_MAXIMUM_DEPTH="OUTLET_MAXIMUM_DEPTH",e.OUTLET_HTTPS_ERROR="OUTLET_HTTPS_ERROR"}(n||(n={}));var o=function(e,t){void 0===t&&(t=[]);var i=t.slice();for(var n in e)"string"==typeof e[n]?i.push(e[n]):"object"==typeof e[n]&&(i=o(e[n],i));return i},s=o(r),a=function(){function e(){this.messages=[]}return e.prototype.push=function(e,t){var i;i="incoming"===e.direction?"yes"===e.handled?"received and handled":"received and skipped":"sending",console.log(t+" "+i+" message: ",e),this.messages.push(e)},e.prototype.all=function(){return this.messages},e.prototype.allTable=function(){console.table(this.all())},e.prototype.filter=function(e){return this.messages.filter((function(t){if(e.type){if(Array.isArray(e.type)&&!e.type.some((function(e){return new RegExp(e).test(t.type)})))return!1;if("string"==typeof e.type&&!RegExp(e.type).test(t.type))return!1}if(e.component){if(Array.isArray(e.component)&&!e.component.some((function(e){return e===t.component})))return!1;if(e.component!==t.component)return!1}return!(e.direction&&e.direction!==t.direction||e.direction&&"incoming"===e.direction&&void 0!==e.handled&&e.handled!==("yes"===t.handled)||e.from&&e.from>t.timestamp||e.to&&e.to<t.timestamp)}))},e.prototype.filterTable=function(e){console.table(this.filter(e))},e}(),u=function(){function e(e,t){if(this.winRef=e,this.debugId=t,this.debugMode=!1,this.debugId){var i=this.winRef.localStorage.getItem("cs.fsm-shell.debug");i&&i.split(",").some((function(e){return e===t}))&&(this.debugMode=!0)}}return e.prototype.traceEvent=function(e,t,i,n,r){if(this.debugMode&&s.some((function(e){return e===t}))){var o={timestamp:new Date,component:this.debugId,direction:e,type:t,handled:"incoming"===e?r?"yes":"no":"n/a",to:n.to,from:n.from,payload:i};this.logEvent(o)}},e.prototype.logEvent=function(e){var t=this.winRef;t.fsmShellMessageLogger||(t.fsmShellMessageLogger=new a),t.fsmShellMessageLogger.push(e,this.debugId)},e}(),l=function(){function e(e,t,i,o,s){var a=this;this.target=e,this.origin=t,this.winRef=i,this.outletMaximumDepth=s,this.allowedOrigins=[],this.ignoredOrigins=[],this.on=function(e,t){return a.subscribersMap.has(e)||a.subscribersMap.set(e,[]),a.subscribersMap.get(e).push(t),function(){a.removeSubscriber(e,t)}},this.onViewState=function(e,t){return a.subscribersViewStateMap.has(e)||a.subscribersViewStateMap.set(e,[]),a.subscribersViewStateMap.get(e).push(t),function(){a.removeViewStateSubscriber(e,t)}},this.off=function(e,t){a.removeSubscriber(e,t)},this.offViewState=function(e,t){a.removeViewStateSubscriber(e,t)},this.onMessage=function(e){if(e.data&&"string"==typeof e.data.type&&(e.source===window.parent||!a.ignoredOrigins||!Array.isArray(a.ignoredOrigins)||0===a.ignoredOrigins.length||-1===a.ignoredOrigins.indexOf(e.origin)))if(e.source!==window.parent&&a.allowedOrigins&&Array.isArray(a.allowedOrigins)&&0!==a.allowedOrigins.length&&-1===a.allowedOrigins.indexOf(e.origin))console.error(e.origin+" is not in the list of known origins");else{var t=e.data;if(t.type!==r.Version1.OUTLET.LOADING_SUCCESS){if(!a.isRoot){var i=e.source;if(i){var o=Array.from(a.outletsMap.keys()).find((function(e){return e.contentWindow===i}));if(o&&o.src){if(new URL(o.src).origin!==e.origin)return void a.debugger.traceEvent("blocked",t.type,t.value,{from:t.from},!1);if(t.type===r.Version1.SET_VIEW_STATE)return void console.warn("[ShellSDk] A plugin tried to update viewState using SetViewState which is not allowed for security reason.");var s=t.from||[];if(t.type===r.Version1.OUTLET.REQUEST_CONTEXT&&s.length>=a.outletMaximumDepth)i.postMessage({type:r.Version1.OUTLET.LOADING_FAIL,value:{target:t.value.target,error:n.OUTLET_MAXIMUM_DEPTH},to:s},a.origin);else{var u=a.outletsMap.get(o);u&&u.uuid&&(t.type===r.Version1.REQUIRE_CONTEXT&&0===s.length&&void 0!==u.name&&(t.value.targetOutletName=u.name),s=s.concat([u.uuid]),a.debugger.traceEvent("outgoing",t.type,t.value,{from:s},!0),a.target.postMessage({type:t.type,value:t.value,from:s},a.origin))}return}if(i!==a.target)return}if(t.type===r.Version1.SET_VIEW_STATE){a.outletsMap.forEach((function(e,i){i.contentWindow&&i.contentWindow.postMessage({type:t.type,value:t.value},a.origin)}));var l=a.subscribersViewStateMap.get(t.value.key);if(a.debugger.traceEvent("incoming",t.type,t.value,{},!!l),l)for(var g=0,c=l;g<c.length;g++)(0,c[g])(t.value.value);return}if(t.type!==r.Version1.OUTLET.REQUEST_CONTEXT||!t.value.hasOwnProperty("isConfigurationMode")||t.value.hasOwnProperty("target")||t.value.hasOwnProperty("plugin")||a.outletsMap.forEach((function(e,i){i.contentWindow&&i.contentWindow.postMessage({type:t.type,value:t.value},a.origin)})),t.to&&0!==t.to.length&&t.type!==r.Version1.TO_APP)return a.debugger.traceEvent("outgoing",t.type,t.value,{to:t.to},!0),void a.outletsMap.forEach((function(e,i){t.to&&-1!==t.to.indexOf(e.uuid)&&i.contentWindow&&i.contentWindow.postMessage({type:t.type,value:t.value,to:t.to.filter((function(t){return t!==e.uuid}))},a.origin)}))}var p=a.subscribersMap.get(t.type);if(a.debugger.traceEvent("incoming",t.type,t.value,{from:t.from},!!p),p)for(var d=0,f=p;d<f.length;d++)(0,f[d])(t.value,e.origin,t.type===r.Version1.SET_VIEW_STATE?null:t.from);if(!a.isRoot&&t.type===r.Version1.REQUIRE_CONTEXT){var E=("string"==typeof t.value?JSON.parse(t.value):t.value).viewState;if(E)for(var T=0,h=Object.keys(E);T<h.length;T++){var S=h[T];if(l=a.subscribersViewStateMap.get(""+S))for(var O=0,v=l;O<v.length;O++)(0,v[O])(E[S])}a.target.postMessage({type:r.Version1.OUTLET.LOADING_SUCCESS},a.origin)}}}},this.subscribersMap=new Map,this.subscribersViewStateMap=new Map,this.outletsMap=new Map,this.initMessageApi(),this.debugger=new u(i,o),this.isRoot=null==e}return e.init=function(t,i,n,r,o){return void 0===n&&(n=window),void 0===r&&(r=""),void 0===o&&(o=1),e._instance=new e(t,i,n,r,o),e._instance},Object.defineProperty(e,"instance",{get:function(){if(!e._instance)throw new Error("ShellSdk wasn't initialized.");return e._instance},enumerable:!0,configurable:!0}),e.isInsideShell=function(){var e=window;return e.self!==e.top},e.prototype.setAllowedOrigins=function(e){void 0===e&&(e=[]),this.allowedOrigins="*"===e?[]:e},e.prototype.addAllowedOrigin=function(e){var t;try{t=new URL(e)}catch(e){return}this.allowedOrigins.push(t.origin)},e.prototype.removeAllowedOrigin=function(e){var t;try{t=new URL(e)}catch(e){return}var i=this.allowedOrigins.findIndex((function(e){return e===t.origin}));this.allowedOrigins=this.allowedOrigins.filter((function(e,t){return t!==i}))},e.prototype.isOriginAllowed=function(e){var t;try{t=new URL(e)}catch(e){return!1}return this.allowedOrigins.some((function(e){return e===t.origin}))},e.prototype.setIgnoredOrigins=function(e){void 0===e&&(e=[]),this.ignoredOrigins=e},e.prototype.addIgnoredOrigin=function(e){var t;try{t=new URL(e)}catch(e){return}this.ignoredOrigins.push(t.origin)},e.prototype.removeIgnoredOrigin=function(e){var t;try{t=new URL(e)}catch(e){return}var i=this.ignoredOrigins.findIndex((function(e){return e===t.origin}));this.ignoredOrigins=this.ignoredOrigins.filter((function(e,t){return t!==i}))},e.prototype.registerOutlet=function(e,t){this.outletsMap.set(e,{uuid:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),name:t})},e.prototype.unregisterOutlet=function(e){this.outletsMap.delete(e)},e.prototype.getTarget=function(){return this.target},e.prototype.setTarget=function(e,t){(this.target!==e||this.origin!==t)&&(this.target=e,this.origin=t)},e.prototype.emit=function(e,t,i){if(!this.postMessageHandler)throw new Error("ShellSdk wasn't initialized, message handler not set.");this.postMessageHandler(e,t,this.isRoot?i:void 0)},e.prototype.setViewState=function(e,t){if(!this.postMessageHandler)throw new Error("ShellSdk wasn't initialized, message handler not set.");this.postMessageHandler(r.Version1.SET_VIEW_STATE,{key:e,value:t})},e.prototype.removeSubscriber=function(e,t){var i=this.subscribersMap.get(e);i&&this.subscribersMap.set(e,i.filter((function(e){return e!==t})))},e.prototype.removeViewStateSubscriber=function(e,t){var i=this.subscribersViewStateMap.get(e);i&&this.subscribersViewStateMap.set(e,i.filter((function(e){return e!==t})))},e.prototype.initMessageApi=function(){var e=this;this.postMessageHandler=function(t,i,n){if(!e.target)throw new Error("ShellSdk wasn't initialized, target is missing.");if(!e.origin)throw new Error("ShellSdk wasn't initialized, origin is missing.");e.debugger.traceEvent("outgoing",t,i,{to:n},!0),e.target.postMessage({type:t,value:i,to:n},e.origin)},this.winRef.addEventListener("message",this.onMessage)},e.VERSION="1.12.1",e.BUILD_TS="2021-08-12T13:10:45.094Z",e}()},607:function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=o(i(38));window.addEventListener("load",(async()=>{let e="";if(s.isInsideShell){const t=await s.getContext();e="<ul>";for(const[i,n]of Object.entries(t))e+="object"==typeof n?`<li>${i}: ${JSON.stringify(n)}</li>`:`<li>${i}: ${n}</li>`;e+="</ul>"}var t;t=e,document.querySelectorAll("#info")[0].innerHTML=t}))},38:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getContext=t.isInsideShell=void 0;const n=i(918);let r;n.ShellSdk.isInsideShell()&&(r=n.ShellSdk.init(parent,"*")),t.isInsideShell=!!r,t.getContext=()=>new Promise(((e,t)=>{r?(r.emit(n.SHELL_EVENTS.Version1.REQUIRE_CONTEXT,{auth:{response_type:"token"}}),r.on(n.SHELL_EVENTS.Version1.REQUIRE_CONTEXT,(t=>{e(JSON.parse(t))}))):t("App is not running inside Shell")}))}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUMsSUFDSCxvQkFBWFMsUUFBMEJBLE9BQU9DLGFBQzFDOUUsT0FBT08sZUFBZTZELEVBQVNTLE9BQU9DLFlBQWEsQ0FBRXRHLE1BQU8sV0FFN0R3QixPQUFPTyxlQUFlNkQsRUFBUyxhQUFjLENBQUU1RixPQUFPLEtDRjdCeUYsRUFBb0IsTSIsInNvdXJjZXMiOlsid2VicGFjazovL2ZzbS1leHRlbnNpb24tc3RhcnRlci1raXQvLi9ub2RlX21vZHVsZXMvZnNtLXNoZWxsL3JlbGVhc2UvZnNtLXNoZWxsLWNsaWVudC5lcy5qcyIsIndlYnBhY2s6Ly9mc20tZXh0ZW5zaW9uLXN0YXJ0ZXIta2l0Ly4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL2ZzbS1leHRlbnNpb24tc3RhcnRlci1raXQvLi9zcmMvc2hlbGwtc2RrLWhlbHBlci50cyIsIndlYnBhY2s6Ly9mc20tZXh0ZW5zaW9uLXN0YXJ0ZXIta2l0L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2ZzbS1leHRlbnNpb24tc3RhcnRlci1raXQvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2ZzbS1leHRlbnNpb24tc3RhcnRlci1raXQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9mc20tZXh0ZW5zaW9uLXN0YXJ0ZXIta2l0L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vZnNtLWV4dGVuc2lvbi1zdGFydGVyLWtpdC93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIFNIRUxMX0VWRU5UUyA9IHtcclxuICAgIFZlcnNpb24xOiB7XHJcbiAgICAgICAgUkVRVUlSRV9DT05URVhUOiAnVjEuUkVRVUlSRV9DT05URVhUJyxcclxuICAgICAgICBSRVFVSVJFX0FVVEhFTlRJQ0FUSU9OOiAnVjEuUkVRVUlSRV9BVVRIRU5USUNBVElPTicsXHJcbiAgICAgICAgQ0xPU0U6ICdWMS5DTE9TRScsXHJcbiAgICAgICAgUkVRVUlSRV9QRVJNSVNTSU9OUzogJ1YxLlJFUVVJUkVfUEVSTUlTU0lPTlMnLFxyXG4gICAgICAgIEdFVF9QRVJNSVNTSU9OUzogJ1YxLkdFVF9QRVJNSVNTSU9OUycsXHJcbiAgICAgICAgR0VUX1NFVFRJTkdTOiAnVjEuR0VUX1NFVFRJTkdTJyxcclxuICAgICAgICBHRVRfU1RPUkFHRV9JVEVNOiAnVjEuR0VUX1NUT1JBR0VfSVRFTScsXHJcbiAgICAgICAgU0VUX1NUT1JBR0VfSVRFTTogJ1YxLlNFVF9TVE9SQUdFX0lURU0nLFxyXG4gICAgICAgIFNFVF9WSUVXX1NUQVRFOiAnVjEuU0VUX1ZJRVdfU1RBVEUnLFxyXG4gICAgICAgIFNFVF9USVRMRTogJ1YxLlNFVF9USVRMRScsXHJcbiAgICAgICAgUkVTVE9SRV9USVRMRTogJ1YxLlJFU1RPUkVfVElUTEUnLFxyXG4gICAgICAgIFRPX0FQUDogJ1YxLlRPX0FQUCcsXHJcbiAgICAgICAgR0VUX0ZFQVRVUkVfRkxBRzogJ1YxLkdFVF9GRUFUVVJFX0ZMQUcnLFxyXG4gICAgICAgIFBSSVZBVEU6IHtcclxuICAgICAgICAgICAgR0VUX0FDQ09VTlRfU0VUVElOR1M6ICdWMS5QUklWQVRFLkdFVF9BQ0NPVU5UX1NFVFRJTkdTJyxcclxuICAgICAgICB9LFxyXG4gICAgICAgIE9VVExFVDoge1xyXG4gICAgICAgICAgICBBRERfUExVR0lOOiAnVjEuT1VUTEVULkFERF9QTFVHSU4nLFxyXG4gICAgICAgICAgICBSRU1PVkVfUExVR0lOOiAnVjEuT1VUTEVULlJFTU9WRV9QTFVHSU4nLFxyXG4gICAgICAgICAgICBSRVFVRVNUX0NPTlRFWFQ6ICdWMS5PVVRMRVQuUkVRVUVTVF9DT05URVhUJyxcclxuICAgICAgICAgICAgTE9BRElOR19TVUNDRVNTOiAnVjEuT1VUTEVULkxPQURJTkdfU1VDQ0VTUycsXHJcbiAgICAgICAgICAgIExPQURJTkdfRkFJTDogJ1YxLk9VVExFVC5MT0FESU5HX0ZBSUwnLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgVmVyc2lvbjI6IHtcclxuICAgICAgICBHRVRfU1RPUkFHRV9JVEVNOiAnVjIuR0VUX1NUT1JBR0VfSVRFTScsXHJcbiAgICAgICAgR0VUX1BFUk1JU1NJT05TOiAnVjIuR0VUX1BFUk1JU1NJT05TJyxcclxuICAgIH0sXHJcbiAgICBFUlJPUjogJ0VSUk9SJyxcclxufTtcclxudmFyIEVycm9yVHlwZTtcclxuKGZ1bmN0aW9uIChFcnJvclR5cGUpIHtcclxuICAgIEVycm9yVHlwZVtcIk9VVExFVF9USU1FT1VUXCJdID0gXCJPVVRMRVRfVElNRU9VVFwiO1xyXG4gICAgRXJyb3JUeXBlW1wiT1VUTEVUX01BWElNVU1fREVQVEhcIl0gPSBcIk9VVExFVF9NQVhJTVVNX0RFUFRIXCI7XHJcbiAgICBFcnJvclR5cGVbXCJPVVRMRVRfSFRUUFNfRVJST1JcIl0gPSBcIk9VVExFVF9IVFRQU19FUlJPUlwiO1xyXG59KShFcnJvclR5cGUgfHwgKEVycm9yVHlwZSA9IHt9KSk7XHJcbnZhciBnZXRLZXlWYWx1ZXMgPSBmdW5jdGlvbiAoc291cmNlLCBpbml0aWFsKSB7XHJcbiAgICBpZiAoaW5pdGlhbCA9PT0gdm9pZCAwKSB7IGluaXRpYWwgPSBbXTsgfVxyXG4gICAgdmFyIHJlc3VsdCA9IGluaXRpYWwuc2xpY2UoKTtcclxuICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHNvdXJjZVtrZXldID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChzb3VyY2Vba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBzb3VyY2Vba2V5XSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gZ2V0S2V5VmFsdWVzKHNvdXJjZVtrZXldLCByZXN1bHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn07XHJcbnZhciBBTExfU0hFTExfRVZFTlRTX0FSUkFZID0gZ2V0S2V5VmFsdWVzKFNIRUxMX0VWRU5UUyk7XG5cbi8vIFRIRSBGSUxFIFNIRUxMVkVSU0lPTklORk8uVFMgSVMgQVVUT01BVElDQUxMWSBHRU5FUkFURUQgRFVSSU5HIEJVSUxEIFBST0NFU1NcclxuLy8gTUFOVUFMIENIQU5HRVMgVE8gVEhJUyBGSUxFIFdJTEwgQkUgT1ZFUldSSVRURU4gISEhXHJcbnZhciBTSEVMTF9WRVJTSU9OX0lORk8gPSB7XHJcbiAgICBWRVJTSU9OOiAnMS4xMi4xJyxcclxuICAgIEJVSUxEX1RTOiAnMjAyMS0wOC0xMlQxMzoxMDo0NS4wOTRaJ1xyXG59O1xuXG52YXIgTWVzc2FnZUxvZ2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lc3NhZ2VMb2dnZXIoKSB7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgTWVzc2FnZUxvZ2dlci5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChldmVudCwgZGVidWdJZCkge1xyXG4gICAgICAgIHZhciBhY3Rpb247XHJcbiAgICAgICAgaWYgKGV2ZW50LmRpcmVjdGlvbiA9PT0gJ2luY29taW5nJykge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQuaGFuZGxlZCA9PT0gJ3llcycpIHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbiA9ICdyZWNlaXZlZCBhbmQgaGFuZGxlZCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhY3Rpb24gPSAncmVjZWl2ZWQgYW5kIHNraXBwZWQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhY3Rpb24gPSAnc2VuZGluZyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGRlYnVnSWQgKyBcIiBcIiArIGFjdGlvbiArIFwiIG1lc3NhZ2U6IFwiLCBldmVudCk7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlcy5wdXNoKGV2ZW50KTtcclxuICAgIH07XHJcbiAgICBNZXNzYWdlTG9nZ2VyLnByb3RvdHlwZS5hbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZXM7XHJcbiAgICB9O1xyXG4gICAgTWVzc2FnZUxvZ2dlci5wcm90b3R5cGUuYWxsVGFibGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS50YWJsZSh0aGlzLmFsbCgpKTtcclxuICAgIH07XHJcbiAgICBNZXNzYWdlTG9nZ2VyLnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1lc3NhZ2VzLmZpbHRlcihmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShvcHRpb25zLnR5cGUpICYmICFvcHRpb25zLnR5cGUuc29tZShmdW5jdGlvbiAodHlwZSkgeyByZXR1cm4gbmV3IFJlZ0V4cCh0eXBlKS50ZXN0KG1lc3NhZ2UudHlwZSk7IH0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMudHlwZSA9PT0gJ3N0cmluZycgJiYgIVJlZ0V4cChvcHRpb25zLnR5cGUpLnRlc3QobWVzc2FnZS50eXBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMuY29tcG9uZW50KSAmJiAhb3B0aW9ucy5jb21wb25lbnQuc29tZShmdW5jdGlvbiAoaXQpIHsgcmV0dXJuIGl0ID09PSBtZXNzYWdlLmNvbXBvbmVudDsgfSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zLmNvbXBvbmVudCAhPT0gbWVzc2FnZS5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGlyZWN0aW9uICYmIG9wdGlvbnMuZGlyZWN0aW9uICE9PSBtZXNzYWdlLmRpcmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRpcmVjdGlvbiAmJlxyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5kaXJlY3Rpb24gPT09ICdpbmNvbWluZycgJiZcclxuICAgICAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zLmhhbmRsZWQgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zLmhhbmRsZWQgIT09IChtZXNzYWdlLmhhbmRsZWQgPT09ICd5ZXMnKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmZyb20gJiYgb3B0aW9ucy5mcm9tID4gbWVzc2FnZS50aW1lc3RhbXApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy50byAmJiBvcHRpb25zLnRvIDwgbWVzc2FnZS50aW1lc3RhbXApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZXNzYWdlTG9nZ2VyLnByb3RvdHlwZS5maWx0ZXJUYWJsZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgY29uc29sZS50YWJsZSh0aGlzLmZpbHRlcihvcHRpb25zKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1lc3NhZ2VMb2dnZXI7XHJcbn0oKSk7XG5cbnZhciBGU01fU0hFTExfREVCVUdfS0VZID0gJ2NzLmZzbS1zaGVsbC5kZWJ1Zyc7XHJcbnZhciBEZWJ1Z2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlYnVnZ2VyKHdpblJlZiwgZGVidWdJZCkge1xyXG4gICAgICAgIHRoaXMud2luUmVmID0gd2luUmVmO1xyXG4gICAgICAgIHRoaXMuZGVidWdJZCA9IGRlYnVnSWQ7XHJcbiAgICAgICAgdGhpcy5kZWJ1Z01vZGUgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5kZWJ1Z0lkKSB7XHJcbiAgICAgICAgICAgIHZhciB3aW4gPSB0aGlzLndpblJlZjtcclxuICAgICAgICAgICAgdmFyIGxvY2FsU3RvcmFnZVZhbHVlID0gd2luLmxvY2FsU3RvcmFnZS5nZXRJdGVtKEZTTV9TSEVMTF9ERUJVR19LRVkpO1xyXG4gICAgICAgICAgICBpZiAoISFsb2NhbFN0b3JhZ2VWYWx1ZSAmJiBsb2NhbFN0b3JhZ2VWYWx1ZS5zcGxpdCgnLCcpLnNvbWUoZnVuY3Rpb24gKGl0KSB7IHJldHVybiBpdCA9PT0gZGVidWdJZDsgfSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVidWdNb2RlID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIERlYnVnZ2VyLnByb3RvdHlwZS50cmFjZUV2ZW50ID0gZnVuY3Rpb24gKGRpcmVjdGlvbiwgdHlwZSwgcGF5bG9hZCwgcm91dGluZywgaGFzSGFuZGxlcikge1xyXG4gICAgICAgIGlmICh0aGlzLmRlYnVnTW9kZSAmJiBBTExfU0hFTExfRVZFTlRTX0FSUkFZLnNvbWUoZnVuY3Rpb24gKGl0KSB7IHJldHVybiBpdCA9PT0gdHlwZTsgfSkpIHtcclxuICAgICAgICAgICAgdmFyIGRlYnVnRXZlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6IHRoaXMuZGVidWdJZCxcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgICAgICAgIGhhbmRsZWQ6IGRpcmVjdGlvbiA9PT0gJ2luY29taW5nJyA/IChoYXNIYW5kbGVyID8gJ3llcycgOiAnbm8nKSA6ICduL2EnLFxyXG4gICAgICAgICAgICAgICAgdG86IHJvdXRpbmcudG8sXHJcbiAgICAgICAgICAgICAgICBmcm9tOiByb3V0aW5nLmZyb20sXHJcbiAgICAgICAgICAgICAgICBwYXlsb2FkOiBwYXlsb2FkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMubG9nRXZlbnQoZGVidWdFdmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERlYnVnZ2VyLnByb3RvdHlwZS5sb2dFdmVudCA9IGZ1bmN0aW9uIChkZWJ1Z0V2ZW50KSB7XHJcbiAgICAgICAgdmFyIHdpbiA9IHRoaXMud2luUmVmO1xyXG4gICAgICAgIGlmICghd2luLmZzbVNoZWxsTWVzc2FnZUxvZ2dlcikge1xyXG4gICAgICAgICAgICB3aW4uZnNtU2hlbGxNZXNzYWdlTG9nZ2VyID0gbmV3IE1lc3NhZ2VMb2dnZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2luLmZzbVNoZWxsTWVzc2FnZUxvZ2dlci5wdXNoKGRlYnVnRXZlbnQsIHRoaXMuZGVidWdJZCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlYnVnZ2VyO1xyXG59KCkpO1xuXG4vLyB0c2xpbnQ6ZGlzYWJsZVxyXG5mdW5jdGlvbiB1dWlkdjQoKSB7XHJcbiAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgIHZhciByID0gKE1hdGgucmFuZG9tKCkgKiAxNikgfCAwO1xyXG4gICAgICAgIHZhciB2ID0gYyA9PSAneCcgPyByIDogKHIgJiAweDMpIHwgMHg4O1xyXG4gICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcclxuICAgIH0pO1xyXG59XHJcbi8vIHRzbGludDplbmFibGVcclxudmFyIERFRkFVTFRfTUFYSU1VTV9ERVBUSCA9IDE7XHJcbnZhciBTaGVsbFNkayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNoZWxsU2RrKHRhcmdldCwgb3JpZ2luLCB3aW5SZWYsIGRlYnVnSWQsIG91dGxldE1heGltdW1EZXB0aCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XHJcbiAgICAgICAgdGhpcy5vcmlnaW4gPSBvcmlnaW47XHJcbiAgICAgICAgdGhpcy53aW5SZWYgPSB3aW5SZWY7XHJcbiAgICAgICAgdGhpcy5vdXRsZXRNYXhpbXVtRGVwdGggPSBvdXRsZXRNYXhpbXVtRGVwdGg7XHJcbiAgICAgICAgdGhpcy5hbGxvd2VkT3JpZ2lucyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaWdub3JlZE9yaWdpbnMgPSBbXTtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgICAgICB0aGlzLm9uID0gZnVuY3Rpb24gKHR5cGUsIHN1YnNjcmliZXIpIHtcclxuICAgICAgICAgICAgaWYgKCFfdGhpcy5zdWJzY3JpYmVyc01hcC5oYXModHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZXJzTWFwLnNldCh0eXBlLCBbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpYmVycyA9IF90aGlzLnN1YnNjcmliZXJzTWFwLmdldCh0eXBlKTtcclxuICAgICAgICAgICAgc3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZVN1YnNjcmliZXIodHlwZSwgc3Vic2NyaWJlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgICAgICB0aGlzLm9uVmlld1N0YXRlID0gZnVuY3Rpb24gKGtleSwgc3Vic2NyaWJlcikge1xyXG4gICAgICAgICAgICBpZiAoIV90aGlzLnN1YnNjcmliZXJzVmlld1N0YXRlTWFwLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVyc1ZpZXdTdGF0ZU1hcC5zZXQoa2V5LCBbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpYmVycyA9IF90aGlzLnN1YnNjcmliZXJzVmlld1N0YXRlTWFwLmdldChrZXkpO1xyXG4gICAgICAgICAgICBzdWJzY3JpYmVycy5wdXNoKHN1YnNjcmliZXIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVtb3ZlVmlld1N0YXRlU3Vic2NyaWJlcihrZXksIHN1YnNjcmliZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcbiAgICAgICAgdGhpcy5vZmYgPSBmdW5jdGlvbiAodHlwZSwgc3Vic2NyaWJlcikge1xyXG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVTdWJzY3JpYmVyKHR5cGUsIHN1YnNjcmliZXIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcbiAgICAgICAgdGhpcy5vZmZWaWV3U3RhdGUgPSBmdW5jdGlvbiAoa2V5LCBzdWJzY3JpYmVyKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZVZpZXdTdGF0ZVN1YnNjcmliZXIoa2V5LCBzdWJzY3JpYmVyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICBNZXNzYWdlIGhhbmRsZXIsIGdlbmVyaWMgZm9yIGFsbCBTaGVsbFNESyBpbnN0YW5jZXMgYnV0IGhhdmUgZGlmZmVyZW50IGJlaGF2aW91cnMgaWYgcm9vdCBvZiBub3QuXHJcbiAgICAgIFxuICAgICAgICAgIC0gSWYgcm9vdCwgd2UgaGFuZGxlIGFsbCBtZXNzYWdlcyB0byBzdWJzY3JpYmVyc1xyXG4gICAgICAgICAgLSBJZiBub3Qgcm9vdCwgYW5kIHJlY2VpdmUgYSBtZXNzYWdlIGZyb20gYW4gaWZyYW1lIHJlZ2lzdGVyZWQgYXMgb3V0bGV0LCB3ZSBzZW5kIHRvIHBhcmVudCBub2RlXHJcbiAgICAgICAgICBhbmQgYWRkIG5vZGUncyBpZCB0byBhbGxvdyByZXR1cm4gaWYgbmVlZGVkLlxyXG4gICAgICAgICAgLSBJZiBub3Qgcm9vdCBhbmQgcmVjZWl2ZSBTRVRfVklFV19TVEFURSwgd2Ugc2V0IG5ldyB2YWx1ZSBvbiBsb2NhbCBub2RlIGFuZCBwcm9wYWdhdGUgdG8gb3V0bGV0c1xyXG4gICAgICAgICAgLSBJZiBub3Qgcm9vdCBhbmQgcmVjZWl2ZSBUT19BUFAsIHdlIGhhbmRsZSBsb2NhbGx5IGFuZCBkbyBub3QgcHJvcGFnYXRlIHRvIG91dGxldHNcclxuICAgICAgICAgIC0gSWYgbm90IHJvb3QgYW5kIHJlY2VpdmUgYW55IG1lc3NhZ2Ugd2l0aCBgdG9gIHZhbHVlLCB3ZSByZW1vdmUgb3VyIGlkIGFuZCBzZW5kIHRvIGRlc3RpbmF0aW9uXHJcbiAgICAgIFxuICAgICAgICAgIEFsc28gZGVmaW5lIGEgbmV3IGV2ZW50IGZvciBSRVFVSVJFX0NPTlRFWFQgd2hpY2ggbm93IGNvbnRhaW5zIFZpZXdTdGF0ZS4gVG8gdXNlIFZpZXdTdGF0ZSBiaW5kaW5nXHJcbiAgICAgICAgICBhbmQgYXZvaWQgZHVwbGljYXRlIGtleSB3ZSBmaXJzdCBwcm92aWRlIFJFUVVJUkVfQ09OVEVYVCB0byBpbml0IGN1cnJyZW50IG5vZGUsIHRoZW4gcHJvcGFnYXRlIGVhY2hcclxuICAgICAgICAgIGtleSBvZiBWaWV3U3RhdGUgaW5kaXZpZHVhbHkgdG8gbWF0Y2ggcG90ZW50aWFsIHN1YnNjcmlwdGlvbnMuIFRvIGF2b2lkIFVJIGdsaXRjaCBhZnRlciB0aGlzIHdlXHJcbiAgICAgICAgICBzZW5kIGFuIGVtcHR5IFJFUVVJUkVfQ09OVEVYVF9ET05FIHRvIGV2ZW50dWFsbHkgYWRqdXN0IFVJIGlmIG5lZWRlZC5cclxuICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMub25NZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmICghZXZlbnQuZGF0YSB8fCB0eXBlb2YgZXZlbnQuZGF0YS50eXBlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgIT09IHdpbmRvdy5wYXJlbnQgJiZcclxuICAgICAgICAgICAgICAgIF90aGlzLmlnbm9yZWRPcmlnaW5zICYmXHJcbiAgICAgICAgICAgICAgICBBcnJheS5pc0FycmF5KF90aGlzLmlnbm9yZWRPcmlnaW5zKSAmJlxyXG4gICAgICAgICAgICAgICAgX3RoaXMuaWdub3JlZE9yaWdpbnMubGVuZ3RoICE9PSAwICYmXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pZ25vcmVkT3JpZ2lucy5pbmRleE9mKGV2ZW50Lm9yaWdpbikgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSAhPT0gd2luZG93LnBhcmVudCAmJlxyXG4gICAgICAgICAgICAgICAgX3RoaXMuYWxsb3dlZE9yaWdpbnMgJiZcclxuICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoX3RoaXMuYWxsb3dlZE9yaWdpbnMpICYmXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5hbGxvd2VkT3JpZ2lucy5sZW5ndGggIT09IDAgJiZcclxuICAgICAgICAgICAgICAgIF90aGlzLmFsbG93ZWRPcmlnaW5zLmluZGV4T2YoZXZlbnQub3JpZ2luKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXZlbnQub3JpZ2luICsgXCIgaXMgbm90IGluIHRoZSBsaXN0IG9mIGtub3duIG9yaWdpbnNcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHBheWxvYWQgPSBldmVudC5kYXRhO1xyXG4gICAgICAgICAgICAvLyB3ZSBpZ25vcmUgTE9BRElORyBTVUNDRVNTIGFzIGl0IGlzIGhhbmRsZWQgYnkgdGhlIG91dGxldCBjb21wb25lbnQgaXRzZWxmXHJcbiAgICAgICAgICAgIGlmIChwYXlsb2FkLnR5cGUgPT09IFNIRUxMX0VWRU5UUy5WZXJzaW9uMS5PVVRMRVQuTE9BRElOR19TVUNDRVNTKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gSWYgY3VycmVudCBpbnN0YW5jZSBpcyBub3Qgcm9vdCwgd2UgYWN0IGFzIG1pZGRsZW1hbiBub2RlIHRvIHByb3BhZ2F0ZVxyXG4gICAgICAgICAgICBpZiAoIV90aGlzLmlzUm9vdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gTWVzc2FnZSBjb21lIGZyb20gYSByZWdpc3RlcmVkIG91dGxldCwgd2Ugc2VuZCB0byBwYXJlbnQgKHRoaXMudGFyZ2V0KSB3aXRoIGEgYGZyb21gIHZhbHVlXHJcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlXzEgPSBldmVudC5zb3VyY2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoc291cmNlXzEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBoYXMgYSBzb3VyY2UsIHdlIGxvb2sgaWYgaXQgY29tZSBmcm9tIG9uZSBvZiBvdXIgSFRNTElGcmFtZUVsZW1lbnRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaUZyYW1lRWxlbWVudCA9IEFycmF5LmZyb20oX3RoaXMub3V0bGV0c01hcC5rZXlzKCkpLmZpbmQoZnVuY3Rpb24gKGZyYW1lKSB7IHJldHVybiBmcmFtZS5jb250ZW50V2luZG93ID09PSBzb3VyY2VfMTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlGcmFtZUVsZW1lbnQgJiYgaUZyYW1lRWxlbWVudC5zcmMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlGcmFtZU9yaWdpbiA9IG5ldyBVUkwoaUZyYW1lRWxlbWVudC5zcmMpLm9yaWdpbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlGcmFtZU9yaWdpbiAhPT0gZXZlbnQub3JpZ2luKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBpdCBjb21lcyBmcm9tIHVucmVnaXN0ZXJlZCBpRnJhbWUgd2UgaWdub3JlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbiBvcmRlciB0byBwcmV2ZW50IHVuYXV0aG9yaXplZCBhY2Nlc3MgdG8gdGhlIGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRlYnVnZ2VyLnRyYWNlRXZlbnQoJ2Jsb2NrZWQnLCBwYXlsb2FkLnR5cGUsIHBheWxvYWQudmFsdWUsIHsgZnJvbTogcGF5bG9hZC5mcm9tIH0sIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBpdCBjb21lIGZyb20gYW4gb3V0bGV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLnR5cGUgPT09IFNIRUxMX0VWRU5UUy5WZXJzaW9uMS5TRVRfVklFV19TVEFURSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdbU2hlbGxTRGtdIEEgcGx1Z2luIHRyaWVkIHRvIHVwZGF0ZSB2aWV3U3RhdGUgdXNpbmcgU2V0Vmlld1N0YXRlIHdoaWNoIGlzIG5vdCBhbGxvd2VkIGZvciBzZWN1cml0eSByZWFzb24uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyb20gPSBwYXlsb2FkLmZyb20gfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIHJlY2VpdmUgZnJvbSBvdXRsZXQgcmVxdWVzdF9jb250ZXh0IHRvIGZldGNoIHBsdWdpbiBmcm9tIHRhcmdldCwgd2UgcmV0dXJuIExPQURJTkdfRkFJTFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB0b28gbWFueSBkZXB0aCBleGNoYW5nZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBheWxvYWQudHlwZSA9PT0gU0hFTExfRVZFTlRTLlZlcnNpb24xLk9VVExFVC5SRVFVRVNUX0NPTlRFWFQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20ubGVuZ3RoID49IF90aGlzLm91dGxldE1heGltdW1EZXB0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNIRUxMX0VWRU5UUy5WZXJzaW9uMS5PVVRMRVQuTE9BRElOR19GQUlMLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcGF5bG9hZC52YWx1ZS50YXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBFcnJvclR5cGUuT1VUTEVUX01BWElNVU1fREVQVEgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogZnJvbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIF90aGlzLm9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3V0bGV0ID0gX3RoaXMub3V0bGV0c01hcC5nZXQoaUZyYW1lRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3V0bGV0ICYmIG91dGxldC51dWlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBheWxvYWQudHlwZSA9PT0gU0hFTExfRVZFTlRTLlZlcnNpb24xLlJFUVVJUkVfQ09OVEVYVCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tLmxlbmd0aCA9PT0gMCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRsZXQubmFtZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBheWxvYWQudmFsdWUudGFyZ2V0T3V0bGV0TmFtZSA9IG91dGxldC5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIHRoZSB1dWlkIG91dGxldCB1c2VkIGZvciByb3V0aW5nIG9mIHNvdXJjZSBvYmplY3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tID0gZnJvbS5jb25jYXQoW291dGxldC51dWlkXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGVidWdnZXIudHJhY2VFdmVudCgnb3V0Z29pbmcnLCBwYXlsb2FkLnR5cGUsIHBheWxvYWQudmFsdWUsIHsgZnJvbTogZnJvbSB9LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy50YXJnZXQucG9zdE1lc3NhZ2UoeyB0eXBlOiBwYXlsb2FkLnR5cGUsIHZhbHVlOiBwYXlsb2FkLnZhbHVlLCBmcm9tOiBmcm9tIH0sIF90aGlzLm9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzb3VyY2VfMSAhPT0gX3RoaXMudGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNoZWxsU2RrIG5vdyBpZ25vcmUgbWVzc2FnZXMgZnJvbSBvdXRsZXRzIGlmIGl0IGhhcyBubyBvdXRsZXQgcmVnaXN0ZXJlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUHJvcGFnYXRlIFNFVF9WSUVXX1NUQVRFIHRvIGNoaWxkcmVucydzIG91dGxldCBhbmRzZXQgdmFsdWUgdG8gY3VycmVudCBzdWJzY3JpYmVyc1xyXG4gICAgICAgICAgICAgICAgaWYgKHBheWxvYWQudHlwZSA9PT0gU0hFTExfRVZFTlRTLlZlcnNpb24xLlNFVF9WSUVXX1NUQVRFKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMub3V0bGV0c01hcC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkuY29udGVudFdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5LmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoeyB0eXBlOiBwYXlsb2FkLnR5cGUsIHZhbHVlOiBwYXlsb2FkLnZhbHVlIH0sIF90aGlzLm9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGhpc1N1YnNjcmliZXJzID0gX3RoaXMuc3Vic2NyaWJlcnNWaWV3U3RhdGVNYXAuZ2V0KHBheWxvYWQudmFsdWUua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5kZWJ1Z2dlci50cmFjZUV2ZW50KCdpbmNvbWluZycsIHBheWxvYWQudHlwZSwgcGF5bG9hZC52YWx1ZSwge30sICEhdGhpc1N1YnNjcmliZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzU3Vic2NyaWJlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB0aGlzU3Vic2NyaWJlcnNfMSA9IHRoaXNTdWJzY3JpYmVyczsgX2kgPCB0aGlzU3Vic2NyaWJlcnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJzY3JpYmVyID0gdGhpc1N1YnNjcmliZXJzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcihwYXlsb2FkLnZhbHVlLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBJZiBTaGVsbFNkayByZWNlaXZlIE9VVExFVC5SRVFVRVNUX0NPTlRFWFQgd2l0aCBvbmx5IGBpc0NvbmZpZ3VyYXRpb25Nb2RlYCB3ZSBwcm9wYWdhdGUgdG8gYWxsIG91dGxldHNcclxuICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLnR5cGUgPT09IFNIRUxMX0VWRU5UUy5WZXJzaW9uMS5PVVRMRVQuUkVRVUVTVF9DT05URVhUICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC52YWx1ZS5oYXNPd25Qcm9wZXJ0eSgnaXNDb25maWd1cmF0aW9uTW9kZScpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIXBheWxvYWQudmFsdWUuaGFzT3duUHJvcGVydHkoJ3RhcmdldCcpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgIXBheWxvYWQudmFsdWUuaGFzT3duUHJvcGVydHkoJ3BsdWdpbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMub3V0bGV0c01hcC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkuY29udGVudFdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5LmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoeyB0eXBlOiBwYXlsb2FkLnR5cGUsIHZhbHVlOiBwYXlsb2FkLnZhbHVlIH0sIF90aGlzLm9yaWdpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIE1lc3NhZ2UgaGFzIGEgYHRvYCB2YWx1ZSwgc2VuZCB0byBhbiBvdXRsZXQgYXMgb25lIHRvIG9uZSBjb21tdW5pY2F0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAocGF5bG9hZC50byAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQudG8ubGVuZ3RoICE9PSAwICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC50eXBlICE9PSBTSEVMTF9FVkVOVFMuVmVyc2lvbjEuVE9fQVBQKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGVidWdnZXIudHJhY2VFdmVudCgnb3V0Z29pbmcnLCBwYXlsb2FkLnR5cGUsIHBheWxvYWQudmFsdWUsIHsgdG86IHBheWxvYWQudG8gfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMub3V0bGV0c01hcC5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkLnRvICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnRvLmluZGV4T2YodmFsdWUudXVpZCkgIT09IC0xICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkuY29udGVudFdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5LmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHBheWxvYWQudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcGF5bG9hZC52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogcGF5bG9hZC50by5maWx0ZXIoZnVuY3Rpb24gKGlkKSB7IHJldHVybiBpZCAhPT0gdmFsdWUudXVpZDsgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBfdGhpcy5vcmlnaW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIElmIGlzUm9vdCBvciBtZXNzYWdlIGlzIGZvciBtZSwgd2Ugc2VuZCB0byBzdWJzY3JpYmVycy9oYW5kbGVyc1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVyc01hcC5nZXQocGF5bG9hZC50eXBlKTtcclxuICAgICAgICAgICAgX3RoaXMuZGVidWdnZXIudHJhY2VFdmVudCgnaW5jb21pbmcnLCBwYXlsb2FkLnR5cGUsIHBheWxvYWQudmFsdWUsIHsgZnJvbTogcGF5bG9hZC5mcm9tIH0sICEhc3Vic2NyaWJlcnMpO1xyXG4gICAgICAgICAgICBpZiAoISFzdWJzY3JpYmVycykge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBzdWJzY3JpYmVyc18xID0gc3Vic2NyaWJlcnM7IF9hIDwgc3Vic2NyaWJlcnNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3Vic2NyaWJlciA9IHN1YnNjcmliZXJzXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIocGF5bG9hZC52YWx1ZSwgZXZlbnQub3JpZ2luLCBwYXlsb2FkLnR5cGUgPT09IFNIRUxMX0VWRU5UUy5WZXJzaW9uMS5TRVRfVklFV19TVEFURVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBwYXlsb2FkLmZyb20pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIE9uIFJFUVVJUkVfQ09OVEVYVCwgd2Ugc3BsaXQgYW5kIHByb3BhZ2F0ZSB2aWV3U3RhdGVcclxuICAgICAgICAgICAgLy8gTmVlZCB0byBiZSBkb25lIEFGVEVSIFJFUVVJUkVfQ09OVEVYVCBldmVudCBpbiBjYXNlIG9mIHBsdWdpbiBuZWVkIGF1dGggb3IgY29udGV4dC5cclxuICAgICAgICAgICAgaWYgKCFfdGhpcy5pc1Jvb3QgJiZcclxuICAgICAgICAgICAgICAgIHBheWxvYWQudHlwZSA9PT0gU0hFTExfRVZFTlRTLlZlcnNpb24xLlJFUVVJUkVfQ09OVEVYVCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0eXBlb2YgcGF5bG9hZC52YWx1ZSA9PT0gJ3N0cmluZydcclxuICAgICAgICAgICAgICAgICAgICA/IEpTT04ucGFyc2UocGF5bG9hZC52YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICA6IHBheWxvYWQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld1N0YXRlID0gY29udGV4dC52aWV3U3RhdGU7XHJcbiAgICAgICAgICAgICAgICBpZiAodmlld1N0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IE9iamVjdC5rZXlzKHZpZXdTdGF0ZSk7IF9iIDwgX2MubGVuZ3RoOyBfYisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBfY1tfYl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzU3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVyc1ZpZXdTdGF0ZU1hcC5nZXQoXCJcIiArIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXNTdWJzY3JpYmVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2QgPSAwLCB0aGlzU3Vic2NyaWJlcnNfMiA9IHRoaXNTdWJzY3JpYmVyczsgX2QgPCB0aGlzU3Vic2NyaWJlcnNfMi5sZW5ndGg7IF9kKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3Vic2NyaWJlciA9IHRoaXNTdWJzY3JpYmVyc18yW19kXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyKHZpZXdTdGF0ZVtrZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF90aGlzLnRhcmdldC5wb3N0TWVzc2FnZSh7IHR5cGU6IFNIRUxMX0VWRU5UUy5WZXJzaW9uMS5PVVRMRVQuTE9BRElOR19TVUNDRVNTIH0sIF90aGlzLm9yaWdpbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlcnNNYXAgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVyc1ZpZXdTdGF0ZU1hcCA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLm91dGxldHNNYXAgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbml0TWVzc2FnZUFwaSgpO1xyXG4gICAgICAgIHRoaXMuZGVidWdnZXIgPSBuZXcgRGVidWdnZXIod2luUmVmLCBkZWJ1Z0lkKTtcclxuICAgICAgICB0aGlzLmlzUm9vdCA9IHRhcmdldCA9PSBudWxsO1xyXG4gICAgfVxyXG4gICAgU2hlbGxTZGsuaW5pdCA9IGZ1bmN0aW9uICh0YXJnZXQsIG9yaWdpbiwgd2luUmVmLCBkZWJ1Z0lkLCBvdXRsZXRNYXhpbXVtRGVwdGgpIHtcclxuICAgICAgICBpZiAod2luUmVmID09PSB2b2lkIDApIHsgd2luUmVmID0gd2luZG93OyB9XHJcbiAgICAgICAgaWYgKGRlYnVnSWQgPT09IHZvaWQgMCkgeyBkZWJ1Z0lkID0gJyc7IH1cclxuICAgICAgICBpZiAob3V0bGV0TWF4aW11bURlcHRoID09PSB2b2lkIDApIHsgb3V0bGV0TWF4aW11bURlcHRoID0gREVGQVVMVF9NQVhJTVVNX0RFUFRIOyB9XHJcbiAgICAgICAgU2hlbGxTZGsuX2luc3RhbmNlID0gbmV3IFNoZWxsU2RrKHRhcmdldCwgb3JpZ2luLCB3aW5SZWYsIGRlYnVnSWQsIG91dGxldE1heGltdW1EZXB0aCk7XHJcbiAgICAgICAgcmV0dXJuIFNoZWxsU2RrLl9pbnN0YW5jZTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2hlbGxTZGssIFwiaW5zdGFuY2VcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIVNoZWxsU2RrLl9pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2hlbGxTZGsgd2Fzbid0IGluaXRpYWxpemVkLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gU2hlbGxTZGsuX2luc3RhbmNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgU2hlbGxTZGsuaXNJbnNpZGVTaGVsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyB1c2luZyBsb2NhbCB2YXJpYWJsZSBmb3Igd2luZG93IHJlZmVyZW5jZSBiZWxvdyBuZWVkZWQgdG8gZml4IGlzc3VlIHdoZW4gcnVubmluZyB0ZXN0c1xyXG4gICAgICAgIC8vIGZvciBhcHBsaWNhdGlvbnMgd2hpY2ggdXNlIGZzbS1zaGVsbCBpbiBjeXByZXNzXHJcbiAgICAgICAgLy8gY3lwcmVzcyBtYXkgcmVwbGFjZSBgd2luZG93LnNlbGYgIT09IHdpbmRvdy50b3BgIHdpdGggYHdpbmRvdy5zZWxmICE9PSB3aW5kb3cuc2VsZmBcclxuICAgICAgICAvLyB3aGF0IG1ha2VzIGlzSW5zaWRlU2hlbGwgbWV0aG9kIHJldHVybmluZyB3cm9uZyB2YWx1ZVxyXG4gICAgICAgIHZhciB3aW5SZWYgPSB3aW5kb3c7XHJcbiAgICAgICAgcmV0dXJuIHdpblJlZi5zZWxmICE9PSB3aW5SZWYudG9wO1xyXG4gICAgfTtcclxuICAgIFNoZWxsU2RrLnByb3RvdHlwZS5zZXRBbGxvd2VkT3JpZ2lucyA9IGZ1bmN0aW9uIChhbGxvd2VkT3JpZ2lucykge1xyXG4gICAgICAgIGlmIChhbGxvd2VkT3JpZ2lucyA9PT0gdm9pZCAwKSB7IGFsbG93ZWRPcmlnaW5zID0gW107IH1cclxuICAgICAgICB0aGlzLmFsbG93ZWRPcmlnaW5zID0gYWxsb3dlZE9yaWdpbnMgPT09ICcqJyA/IFtdIDogYWxsb3dlZE9yaWdpbnM7XHJcbiAgICB9O1xyXG4gICAgU2hlbGxTZGsucHJvdG90eXBlLmFkZEFsbG93ZWRPcmlnaW4gPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdmFyIHVybE9iajtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB1cmxPYmogPSBuZXcgVVJMKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWxsb3dlZE9yaWdpbnMucHVzaCh1cmxPYmoub3JpZ2luKTtcclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUucmVtb3ZlQWxsb3dlZE9yaWdpbiA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB2YXIgdXJsT2JqO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHVybE9iaiA9IG5ldyBVUkwodXJsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGlkeFRvUmVtb3ZlID0gdGhpcy5hbGxvd2VkT3JpZ2lucy5maW5kSW5kZXgoZnVuY3Rpb24gKGFsbG93ZWRPcmlnaW4pIHsgcmV0dXJuIGFsbG93ZWRPcmlnaW4gPT09IHVybE9iai5vcmlnaW47IH0pO1xyXG4gICAgICAgIHRoaXMuYWxsb3dlZE9yaWdpbnMgPSB0aGlzLmFsbG93ZWRPcmlnaW5zLmZpbHRlcihmdW5jdGlvbiAoX2FsbG93ZWRPcmlnaW4sIG9yaWdpbklkeCkgeyByZXR1cm4gb3JpZ2luSWR4ICE9PSBpZHhUb1JlbW92ZTsgfSk7XHJcbiAgICB9O1xyXG4gICAgU2hlbGxTZGsucHJvdG90eXBlLmlzT3JpZ2luQWxsb3dlZCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB2YXIgdXJsT2JqO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHVybE9iaiA9IG5ldyBVUkwodXJsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsb3dlZE9yaWdpbnMuc29tZShmdW5jdGlvbiAoYWxsb3dlZE9yaWdpbikgeyByZXR1cm4gYWxsb3dlZE9yaWdpbiA9PT0gdXJsT2JqLm9yaWdpbjsgfSk7XHJcbiAgICB9O1xyXG4gICAgU2hlbGxTZGsucHJvdG90eXBlLnNldElnbm9yZWRPcmlnaW5zID0gZnVuY3Rpb24gKGlnbm9yZWRPcmlnaW5zKSB7XHJcbiAgICAgICAgaWYgKGlnbm9yZWRPcmlnaW5zID09PSB2b2lkIDApIHsgaWdub3JlZE9yaWdpbnMgPSBbXTsgfVxyXG4gICAgICAgIHRoaXMuaWdub3JlZE9yaWdpbnMgPSBpZ25vcmVkT3JpZ2lucztcclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUuYWRkSWdub3JlZE9yaWdpbiA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB2YXIgdXJsT2JqO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHVybE9iaiA9IG5ldyBVUkwodXJsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pZ25vcmVkT3JpZ2lucy5wdXNoKHVybE9iai5vcmlnaW4pO1xyXG4gICAgfTtcclxuICAgIFNoZWxsU2RrLnByb3RvdHlwZS5yZW1vdmVJZ25vcmVkT3JpZ2luID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHZhciB1cmxPYmo7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdXJsT2JqID0gbmV3IFVSTCh1cmwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaWR4VG9SZW1vdmUgPSB0aGlzLmlnbm9yZWRPcmlnaW5zLmZpbmRJbmRleChmdW5jdGlvbiAoaWdub3JlZE9yaWdpbnMpIHsgcmV0dXJuIGlnbm9yZWRPcmlnaW5zID09PSB1cmxPYmoub3JpZ2luOyB9KTtcclxuICAgICAgICB0aGlzLmlnbm9yZWRPcmlnaW5zID0gdGhpcy5pZ25vcmVkT3JpZ2lucy5maWx0ZXIoZnVuY3Rpb24gKF9pZ25vcmVkT3JpZ2lucywgb3JpZ2luSWR4KSB7IHJldHVybiBvcmlnaW5JZHggIT09IGlkeFRvUmVtb3ZlOyB9KTtcclxuICAgIH07XHJcbiAgICAvLyBDYWxsZWQgYnkgb3V0bGV0IGNvbXBvbmVudCB0byBhc3NpZ24gYW4gZ2VuZXJhdGVkIHV1aWQgdG8gYW4gaWZyYW1lLiBUaGlzIGlzIGtleVxyXG4gICAgLy8gdG8gYWxsb3cgb25lIHRvIG9uZSBjb21tdW5pY2F0aW9uIGJldHdlZW4gYSBwbHVnaW5nIGFuZCBzaGVsbC1ob3N0XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUucmVnaXN0ZXJPdXRsZXQgPSBmdW5jdGlvbiAoZnJhbWUsIF9uYW1lKSB7XHJcbiAgICAgICAgdGhpcy5vdXRsZXRzTWFwLnNldChmcmFtZSwge1xyXG4gICAgICAgICAgICB1dWlkOiB1dWlkdjQoKSxcclxuICAgICAgICAgICAgbmFtZTogX25hbWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2hlbGxTZGsucHJvdG90eXBlLnVucmVnaXN0ZXJPdXRsZXQgPSBmdW5jdGlvbiAoZnJhbWUpIHtcclxuICAgICAgICB0aGlzLm91dGxldHNNYXAuZGVsZXRlKGZyYW1lKTtcclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUuZ2V0VGFyZ2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRhcmdldDtcclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUuc2V0VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldCwgb3JpZ2luKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldENoYW5nZWQgPSB0aGlzLnRhcmdldCAhPT0gdGFyZ2V0IHx8IHRoaXMub3JpZ2luICE9PSBvcmlnaW47XHJcbiAgICAgICAgaWYgKHRhcmdldENoYW5nZWQpIHtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luID0gb3JpZ2luO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uICh0eXBlLCB2YWx1ZSwgdG8pIHtcclxuICAgICAgICBpZiAoIXRoaXMucG9zdE1lc3NhZ2VIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNoZWxsU2RrIHdhc24ndCBpbml0aWFsaXplZCwgbWVzc2FnZSBoYW5kbGVyIG5vdCBzZXQuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBPbmx5IHJvb3QgY2FuIHNlbmQgYSBtZXNzYWdlIHRvIGEgc3BlY2lmaWMgbm9kZVxyXG4gICAgICAgIHRoaXMucG9zdE1lc3NhZ2VIYW5kbGVyKHR5cGUsIHZhbHVlLCB0aGlzLmlzUm9vdCA/IHRvIDogdW5kZWZpbmVkKTtcclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUuc2V0Vmlld1N0YXRlID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMucG9zdE1lc3NhZ2VIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNoZWxsU2RrIHdhc24ndCBpbml0aWFsaXplZCwgbWVzc2FnZSBoYW5kbGVyIG5vdCBzZXQuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvc3RNZXNzYWdlSGFuZGxlcihTSEVMTF9FVkVOVFMuVmVyc2lvbjEuU0VUX1ZJRVdfU1RBVEUsIHtcclxuICAgICAgICAgICAga2V5OiBrZXksXHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgIFNoZWxsU2RrLnByb3RvdHlwZS5yZW1vdmVTdWJzY3JpYmVyID0gZnVuY3Rpb24gKHR5cGUsIHN1YnNjcmliZXIpIHtcclxuICAgICAgICB2YXIgc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzTWFwLmdldCh0eXBlKTtcclxuICAgICAgICBpZiAoISFzdWJzY3JpYmVycykge1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZXJzTWFwLnNldCh0eXBlLCBzdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKGl0KSB7IHJldHVybiBpdCAhPT0gc3Vic2NyaWJlcjsgfSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgIFNoZWxsU2RrLnByb3RvdHlwZS5yZW1vdmVWaWV3U3RhdGVTdWJzY3JpYmVyID0gZnVuY3Rpb24gKHR5cGUsIHN1YnNjcmliZXIpIHtcclxuICAgICAgICB2YXIgc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzVmlld1N0YXRlTWFwLmdldCh0eXBlKTtcclxuICAgICAgICBpZiAoISFzdWJzY3JpYmVycykge1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZXJzVmlld1N0YXRlTWFwLnNldCh0eXBlLCBzdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKGl0KSB7IHJldHVybiBpdCAhPT0gc3Vic2NyaWJlcjsgfSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTaGVsbFNkay5wcm90b3R5cGUuaW5pdE1lc3NhZ2VBcGkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnBvc3RNZXNzYWdlSGFuZGxlciA9IGZ1bmN0aW9uICh0eXBlLCB2YWx1ZSwgdG8pIHtcclxuICAgICAgICAgICAgaWYgKCFfdGhpcy50YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNoZWxsU2RrIHdhc24ndCBpbml0aWFsaXplZCwgdGFyZ2V0IGlzIG1pc3NpbmcuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghX3RoaXMub3JpZ2luKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTaGVsbFNkayB3YXNuJ3QgaW5pdGlhbGl6ZWQsIG9yaWdpbiBpcyBtaXNzaW5nLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpcy5kZWJ1Z2dlci50cmFjZUV2ZW50KCdvdXRnb2luZycsIHR5cGUsIHZhbHVlLCB7IHRvOiB0byB9LCB0cnVlKTtcclxuICAgICAgICAgICAgX3RoaXMudGFyZ2V0LnBvc3RNZXNzYWdlKHsgdHlwZTogdHlwZSwgdmFsdWU6IHZhbHVlLCB0bzogdG8gfSwgX3RoaXMub3JpZ2luKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMud2luUmVmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uTWVzc2FnZSk7XHJcbiAgICB9O1xyXG4gICAgU2hlbGxTZGsuVkVSU0lPTiA9IFNIRUxMX1ZFUlNJT05fSU5GTy5WRVJTSU9OO1xyXG4gICAgU2hlbGxTZGsuQlVJTERfVFMgPSBTSEVMTF9WRVJTSU9OX0lORk8uQlVJTERfVFM7XHJcbiAgICByZXR1cm4gU2hlbGxTZGs7XHJcbn0oKSk7XG5cbmV4cG9ydCB7IEVycm9yVHlwZSwgU0hFTExfRVZFTlRTLCBTaGVsbFNkayB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnNtLXNoZWxsLWNsaWVudC5lcy5qcy5tYXBcbiIsImltcG9ydCAqIGFzIHNoZWxsU2RrSGVscGVyIGZyb20gJy4vc2hlbGwtc2RrLWhlbHBlcic7XG5cblxuY29uc3QgdXBkYXRlVUkgPSAodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNpbmZvJylbMF0gYXMgYW55KS5pbm5lckhUTUwgPSB0ZXh0O1xufTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBhc3luYyAoKSA9PiB7XG5cbiAgICBsZXQgVUlDb250ZXh0TGlzdCA9ICcnO1xuXG4gICAgaWYgKHNoZWxsU2RrSGVscGVyLmlzSW5zaWRlU2hlbGwpIHtcbiAgICAgICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHNoZWxsU2RrSGVscGVyLmdldENvbnRleHQoKTtcblxuICAgICAgICBVSUNvbnRleHRMaXN0ID0gJzx1bD4nO1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhjb250ZXh0KSkge1xuICAgICAgICAgICAgVUlDb250ZXh0TGlzdCA9IFVJQ29udGV4dExpc3QgKyAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyA/XG4gICAgICAgICAgICAgICAgJzxsaT4nICsgYCR7a2V5fTogJHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9YCArICc8L2xpPicgOlxuICAgICAgICAgICAgICAgICc8bGk+JyArIGAke2tleX06ICR7dmFsdWV9YCArICc8L2xpPicpO1xuICAgICAgICB9XG4gICAgICAgIFVJQ29udGV4dExpc3QgPSBVSUNvbnRleHRMaXN0ICsgJzwvdWw+JztcbiAgICB9XG5cbiAgICB1cGRhdGVVSShVSUNvbnRleHRMaXN0KTtcbn0pO1xuIiwiXG5pbXBvcnQgeyBTaGVsbFNkaywgU0hFTExfRVZFTlRTIH0gZnJvbSAnZnNtLXNoZWxsJztcblxuXG4vLyBJbml0aWFsaXplIFNoZWxsU0RLIHRvIGNvbm5lY3Qgd2l0aCBwYXJlbnQgc2hlbGwgbGlicmFyeVxubGV0IHNoZWxsU2RrOiBTaGVsbFNkayB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbmlmIChTaGVsbFNkay5pc0luc2lkZVNoZWxsKCkpIHtcbiAgc2hlbGxTZGsgPSBTaGVsbFNkay5pbml0KHBhcmVudCwgJyonKTtcbn1cblxuXG5leHBvcnQgY29uc3QgaXNJbnNpZGVTaGVsbCA9ICEhc2hlbGxTZGs7XG5cbmV4cG9ydCBjb25zdCBnZXRDb250ZXh0ID0gKCkgPT4gbmV3IFByb21pc2U8e1t4OiBzdHJpbmddOiBhbnl9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgaWYgKCFzaGVsbFNkaykgeyByZWplY3QoJ0FwcCBpcyBub3QgcnVubmluZyBpbnNpZGUgU2hlbGwnKTsgcmV0dXJuOyB9XG5cbiAgLy8gSW5pdGlhbGl6ZSB0aGUgZXh0ZW5zaW9uIGJ5IHJlcXVlc3RpbmcgdGhlIGZzbSBjb250ZXh0XG4gIHNoZWxsU2RrLmVtaXQoU0hFTExfRVZFTlRTLlZlcnNpb24xLlJFUVVJUkVfQ09OVEVYVCwge1xuICAgIGF1dGg6IHtcbiAgICAgIHJlc3BvbnNlX3R5cGU6ICd0b2tlbicgIC8vIHJlcXVlc3QgYSB1c2VyIHRva2VuIHdpdGhpbiB0aGUgY29udGV4dFxuICAgIH1cbiAgfSk7XG5cbiAgLy8gQ2FsbGJhY2sgb24gZnNtIGNvbnRleHQgcmVzcG9uc2VcbiAgc2hlbGxTZGsub24oU0hFTExfRVZFTlRTLlZlcnNpb24xLlJFUVVJUkVfQ09OVEVYVCwgKGV2ZW50OiBzdHJpbmcpID0+IHtcbiAgICByZXNvbHZlKEpTT04ucGFyc2UoZXZlbnQpKTtcbiAgfSk7XG5cbn0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNjA3KTtcbiJdLCJuYW1lcyI6WyJFcnJvclR5cGUiLCJTSEVMTF9FVkVOVFMiLCJWZXJzaW9uMSIsIlJFUVVJUkVfQ09OVEVYVCIsIlJFUVVJUkVfQVVUSEVOVElDQVRJT04iLCJDTE9TRSIsIlJFUVVJUkVfUEVSTUlTU0lPTlMiLCJHRVRfUEVSTUlTU0lPTlMiLCJHRVRfU0VUVElOR1MiLCJHRVRfU1RPUkFHRV9JVEVNIiwiU0VUX1NUT1JBR0VfSVRFTSIsIlNFVF9WSUVXX1NUQVRFIiwiU0VUX1RJVExFIiwiUkVTVE9SRV9USVRMRSIsIlRPX0FQUCIsIkdFVF9GRUFUVVJFX0ZMQUciLCJQUklWQVRFIiwiR0VUX0FDQ09VTlRfU0VUVElOR1MiLCJPVVRMRVQiLCJBRERfUExVR0lOIiwiUkVNT1ZFX1BMVUdJTiIsIlJFUVVFU1RfQ09OVEVYVCIsIkxPQURJTkdfU1VDQ0VTUyIsIkxPQURJTkdfRkFJTCIsIlZlcnNpb24yIiwiRVJST1IiLCJnZXRLZXlWYWx1ZXMiLCJzb3VyY2UiLCJpbml0aWFsIiwicmVzdWx0Iiwic2xpY2UiLCJrZXkiLCJwdXNoIiwiQUxMX1NIRUxMX0VWRU5UU19BUlJBWSIsIk1lc3NhZ2VMb2dnZXIiLCJ0aGlzIiwibWVzc2FnZXMiLCJwcm90b3R5cGUiLCJldmVudCIsImRlYnVnSWQiLCJhY3Rpb24iLCJkaXJlY3Rpb24iLCJoYW5kbGVkIiwiY29uc29sZSIsImxvZyIsImFsbCIsImFsbFRhYmxlIiwidGFibGUiLCJmaWx0ZXIiLCJvcHRpb25zIiwibWVzc2FnZSIsInR5cGUiLCJBcnJheSIsImlzQXJyYXkiLCJzb21lIiwiUmVnRXhwIiwidGVzdCIsImNvbXBvbmVudCIsIml0IiwiZnJvbSIsInRpbWVzdGFtcCIsInRvIiwiZmlsdGVyVGFibGUiLCJEZWJ1Z2dlciIsIndpblJlZiIsImRlYnVnTW9kZSIsImxvY2FsU3RvcmFnZVZhbHVlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInNwbGl0IiwidHJhY2VFdmVudCIsInBheWxvYWQiLCJyb3V0aW5nIiwiaGFzSGFuZGxlciIsImRlYnVnRXZlbnQiLCJEYXRlIiwibG9nRXZlbnQiLCJ3aW4iLCJmc21TaGVsbE1lc3NhZ2VMb2dnZXIiLCJTaGVsbFNkayIsInRhcmdldCIsIm9yaWdpbiIsIm91dGxldE1heGltdW1EZXB0aCIsIl90aGlzIiwiYWxsb3dlZE9yaWdpbnMiLCJpZ25vcmVkT3JpZ2lucyIsIm9uIiwic3Vic2NyaWJlciIsInN1YnNjcmliZXJzTWFwIiwiaGFzIiwic2V0IiwiZ2V0IiwicmVtb3ZlU3Vic2NyaWJlciIsIm9uVmlld1N0YXRlIiwic3Vic2NyaWJlcnNWaWV3U3RhdGVNYXAiLCJyZW1vdmVWaWV3U3RhdGVTdWJzY3JpYmVyIiwib2ZmIiwib2ZmVmlld1N0YXRlIiwib25NZXNzYWdlIiwiZGF0YSIsIndpbmRvdyIsInBhcmVudCIsImxlbmd0aCIsImluZGV4T2YiLCJlcnJvciIsImlzUm9vdCIsInNvdXJjZV8xIiwiaUZyYW1lRWxlbWVudCIsIm91dGxldHNNYXAiLCJrZXlzIiwiZmluZCIsImZyYW1lIiwiY29udGVudFdpbmRvdyIsInNyYyIsIlVSTCIsImRlYnVnZ2VyIiwidmFsdWUiLCJ3YXJuIiwicG9zdE1lc3NhZ2UiLCJPVVRMRVRfTUFYSU1VTV9ERVBUSCIsIm91dGxldCIsInV1aWQiLCJ1bmRlZmluZWQiLCJuYW1lIiwidGFyZ2V0T3V0bGV0TmFtZSIsImNvbmNhdCIsImZvckVhY2giLCJ0aGlzU3Vic2NyaWJlcnMiLCJfaSIsInRoaXNTdWJzY3JpYmVyc18xIiwiaGFzT3duUHJvcGVydHkiLCJpZCIsInN1YnNjcmliZXJzIiwiX2EiLCJzdWJzY3JpYmVyc18xIiwidmlld1N0YXRlIiwiSlNPTiIsInBhcnNlIiwiX2IiLCJfYyIsIk9iamVjdCIsIl9kIiwidGhpc1N1YnNjcmliZXJzXzIiLCJNYXAiLCJpbml0TWVzc2FnZUFwaSIsImluaXQiLCJfaW5zdGFuY2UiLCJkZWZpbmVQcm9wZXJ0eSIsIkVycm9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsImlzSW5zaWRlU2hlbGwiLCJzZWxmIiwidG9wIiwic2V0QWxsb3dlZE9yaWdpbnMiLCJhZGRBbGxvd2VkT3JpZ2luIiwidXJsIiwidXJsT2JqIiwicmVtb3ZlQWxsb3dlZE9yaWdpbiIsImlkeFRvUmVtb3ZlIiwiZmluZEluZGV4IiwiYWxsb3dlZE9yaWdpbiIsIl9hbGxvd2VkT3JpZ2luIiwib3JpZ2luSWR4IiwiaXNPcmlnaW5BbGxvd2VkIiwic2V0SWdub3JlZE9yaWdpbnMiLCJhZGRJZ25vcmVkT3JpZ2luIiwicmVtb3ZlSWdub3JlZE9yaWdpbiIsIl9pZ25vcmVkT3JpZ2lucyIsInJlZ2lzdGVyT3V0bGV0IiwiX25hbWUiLCJyZXBsYWNlIiwiYyIsInIiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJ1bnJlZ2lzdGVyT3V0bGV0IiwiZGVsZXRlIiwiZ2V0VGFyZ2V0Iiwic2V0VGFyZ2V0IiwiZW1pdCIsInBvc3RNZXNzYWdlSGFuZGxlciIsInNldFZpZXdTdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJWRVJTSU9OIiwiQlVJTERfVFMiLCJhc3luYyIsIlVJQ29udGV4dExpc3QiLCJzaGVsbFNka0hlbHBlciIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiZW50cmllcyIsInN0cmluZ2lmeSIsInRleHQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbm5lckhUTUwiLCJzaGVsbFNkayIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiYXV0aCIsInJlc3BvbnNlX3R5cGUiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJvYmoiLCJwcm9wIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciXSwic291cmNlUm9vdCI6IiJ9